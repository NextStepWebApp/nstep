# nstep

An open source website/webapp package manager written in Go for updating the NextStep web application and rolling back to previous versions.

## Installation

nstep can be installed from our custom Arch repository:

```bash
bash <(curl -sL https://github.com/NextStepWebApp/nstep-arch-repo/raw/refs/heads/main/setup.sh)
```

This is the one-line setup script. For manual installation steps, visit https://github.com/NextStepWebApp/nstep-arch-repo

We are planning to create an AUR package once we reach a stable release. We also want to support multiple distributions in the future.

## About

The package manager was originally made to manage the NextStep alumni tracking application. However, we developed it around config files so it should work with other websites and webapps. NextStep will be a locally hosted alumni tracking system, and nstep provides very easy management, especially for non-technical people.

This project, along with others in the NextStepWebApp repository, is being developed as a senior year high school final project.

## Configuration

nstep requires three configuration files to run: `package.json`, `setup.json`, and `nstep.toml`. The `state.json` file is generated by the package manager itself.

### config.json

```json
{
  "packages": {
    "file_path": "/etc/nstep/package.json",
    "setup_file": "/etc/nstep/setup.json"
  },
  "nstep": {
    "settingsfile": "/etc/nstep/nstep.toml",
    "nstepdownloadpath": "/var/lib/nstep/downloads",
    "nstepversionpath": "/var/lib/nstep/versions",
    "nstepcurrentpath": "/var/lib/nstep/current",
    "nstepbackuppath": "/var/lib/nstep/backup",
    "lockfile": "/var/lib/nstep/nstep.lock",
    "statefile": "/var/lib/nstep/state.json"
  }
}
```

### setup.json

The `setup.json` file is only used to initialize the package manager and fetch the `package.json` from the remote repository.

```json
{
  "project_name": "NextStep Web App",
  "version_url": "https://raw.githubusercontent.com/NextStepWebApp/NextStep/refs/heads/main/package.json"
}
```

### nstep.toml

The `nstep.toml` file contains user settings for the package manager.

```toml
# /etc/nstep/nstep.toml
[output]
verbose = true

[permissions.defaults]
files = 644
directories = 755
executables = 755
sensitive = 600

[shell]
shell = "bash"
```

**Note:** Updates from the nstep-git package from our custom repo will overwrite `nstep.toml`. Since nstep is not stable yet, this configuration file will likely be expanded in the future.

## Package Structure

### package.json

The `package.json` sits in a remote repository and acts as the package build file. Currently located at:
https://github.com/NextStepWebApp/NextStep/blob/main/package.json

This location will change once nstep supports multiple packages (web apps).

```json
{
  "version": "v0.1.1",
  "package_version": 1,
  "download_url": "https://github.com/NextStepWebApp/NextStep/archive/refs/tags/v0.1.0.tar.gz",
  "package_url": "https://raw.githubusercontent.com/NextStepWebApp/NextStep/refs/heads/main/package.json",
  "checksum": "4aad3bf2b1e3af26d22dba3351c6c8f3442d474c76250fdfa4c97af433be3f2d",
  "release_notes": "Testing version"
}
```

### version.json

The `version.json` file indicates what version of the webapp the package.json (package build) version is for. It includes the download URL, package URL, checksum of the webapp, and release notes.

To make nstep a multi-package manager, we will need a repository with directories for each webapp, each containing `version.json` and `package.json` files.

## Future Development

The name nstep comes from the NextStep web application that the package manager was built for, but it also suits a multi-webapp package manager, where "n" would be a parameter (n-step).

### To-Do List

- Add plugin support (initially monolithic style, later support for external plugins)
- Multi-package manager support
- Polish the current state and complete unfinished commands

nstep will allow NextStep developers to keep pushing updates to a locally hosted alumni system with ease.

## Contributing

Contributions are very welcome. Please make sure to communicate and open an issue before working on something to avoid duplicate efforts.
